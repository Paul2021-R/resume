# 🖨️ ft_printf: 가변 인자의 세계로 떠난 출력의 마법사 되기

`libft`와 `get_next_line`을 통해 C언어와 조금 친해졌다고 생각했을 무렵, `ft_printf`라는 거대한 산이 나타났어. 우리가 코딩을 배우면서 가장 먼저, 그리고 가장 많이 사용하는 함수 `printf`. 이걸 직접 내 손으로 구현해야 한다니! 처음엔 그저 막막하기만 했지. "아니, 인자를 몇 개 받을 줄 알고...?" 🤷‍♂️

이 프로젝트는 바로 그 **'알 수 없는 개수의 인자'**, 즉 **가변 인자(Variadic Functions)**를 다루는 방법을 배우는 것이 핵심이었어. C언어의 깊은 곳에 숨겨진 마법 같은 기능을 탐험하는 여정이었달까.

## 🎩 가변 인자 마법 আয়ত্ত하기 (Mastering the Magic of Variadic Functions)

`ft_printf`의 심장은 단연 `<stdarg.h>` 헤더 파일에 있었어. 이 안에 숨겨진 마법 도구들을 사용해야만 비로소 가변 인자를 다룰 수 있었거든.

-   `va_list`: 인자들의 목록을 담는 포인터. 마치 마법사의 요술 주머니 같았지.
-   `va_start`: 요술 주머니를 열어 인자 목록을 초기화하는 주문.
-   `va_arg`: 주머니에서 인자를 하나씩 꺼내는 마법! 이때 어떤 자료형(type)의 인자를 꺼낼지 정확히 알려줘야 했어.
-   `va_end`: 모든 인자를 다 사용한 뒤, 요술 주머니를 깔끔하게 정리하는 마무리 주문.

이 네 가지 마법을 이용해 `ft_printf("정수: %d, 문자열: %s", 123, "hello");` 와 같은 호출에서 `%d` 뒤에는 `int`가, `%s` 뒤에는 `char *`가 올 것을 예측하고, `va_arg`로 정확한 자료형의 인자를 꺼내오는 것이 관건이었어.

## 🧩 서식 지정자(Format Specifier) 파싱과 분기 처리

`ft_printf`는 단순히 인자를 꺼내오는 것에서 그치지 않았어. `%` 뒤에 어떤 문자가 오느냐에 따라 전혀 다른 동작을 해야 했지.

```c
// 내가 처리해야 했던 서식 지정자들
c s p d i u x X %
```

메인 함수는 전달받은 문자열을 한 글자씩 순회하다가, `%`를 만나면 그 뒤에 오는 서식 지정자를 확인하고, 각 케이스에 맞는 처리 함수를 호출해주는 방식으로 구현했어.

-   **`%c`, `%s`, `%%`**: 비교적 간단했지. 문자는 그대로 출력하고, 문자열은 `NULL`일 경우 "(null)"을 출력하는 예외 처리만 잘 해주면 됐어. `%%`는 그냥 '%' 문자 하나를 출력하면 끝!
-   **`%d`, `%i`, `%u`**: 십진수 정수를 출력하는 파트. `libft`에서 만들었던 `ft_itoa`를 재활용하거나, `unsigned int`를 처리하기 위한 `ft_uitoa` 같은 함수를 새로 만들어야 했어. 특히 `INT_MIN` 같은 극단적인 값을 처리할 때 골치가 좀 아팠지. 😅
-   **`%x`, `%X`**: 16진수 출력이 필요했어. 10진수를 16진수로 변환하는 로직을 짜야 했는데, 나머지와 몫을 이용해 재귀적으로 처리하는 방법이 유용했어. `%X`는 결과물을 대문자로만 바꿔주면 OK!
-   **`%p`**: 포인터의 메모리 주소를 16진수로 출력하는 서식 지정자. 보통 "0x"라는 접두사를 붙여주는 게 관례라, 이 부분도 신경 써서 구현해야 했어.

## 🏗️ 코드 구조와 발전 (Code Structure & Evolution)

처음에는 모든 로직을 하나의 거대한 함수에 다 넣으려고 했어. 하지만 곧 그게 얼마나 끔찍한 생각인지 깨달았지. 😂

결국, `%`를 만났을 때 서식 지정자를 분석하고 각 타입에 맞는 함수를 호출해주는 `switch_str` 같은 분기용 함수를 만들고, 각 타입별로 실제 문자열 변환과 출력을 담당하는 `ft_put_integer`, `ft_put_hex` 같은 하위 함수들을 두는 식으로 코드를 구조화했어. 이렇게 역할을 나누니 디버깅도 훨씬 수월해지고 코드도 깔끔해졌지.

특히 `printf_new` 폴더를 보면 알 수 있듯이, 처음에는 연결 리스트를 사용해서 출력할 문자열 조각들을 전부 만들고 마지막에 한 번에 출력하는 복잡한 방법도 시도해봤어. 하지만 결국엔 각 서식 지정자를 만날 때마다 `write` 함수로 즉시 출력하는 방식으로 리팩토링했는데, 이게 훨씬 직관적이고 효율적이라는 걸 깨달았지. 이런試行錯誤(시행착오) 자체가 큰 배움이었어.

## 🤔 성찰 및 배운 점 (Reflection & Lessons Learned)

`ft_printf`는 C언어의 또 다른 이면을 보여준 프로젝트였어.

-   **가변 인자의 이해**: 이제 `...`가 붙은 함수를 봐도 당황하지 않을 자신감이 생겼어.
-   **모듈화의 중요성**: 복잡한 기능을 잘게 쪼개어 함수 단위로 구현하는 것이 얼마나 중요한지 뼈저리게 느꼈어.
-   **꼼꼼함의 끝판왕**: `NULL` 포인터, 정수의 최솟값/최댓값 등 온갖 예외 상황을 처리하면서 방어적인 코딩 습관을 기를 수 있었지.

`printf`라는, 매일같이 무심코 쓰던 함수 안에 이렇게 깊은 고민과 복잡한 로직이 숨어있다는 사실에 놀라웠어. 이 프로젝트를 끝내고 나니, 내가 C언어를 좀 더 깊이 이해하게 된 것 같아 뿌듯했지. 이제 어떤 변수든 자신 있게 출력할 수 있는 나만의 무기가 생긴 기분이야! 🚀
