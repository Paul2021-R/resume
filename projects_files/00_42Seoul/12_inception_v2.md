## 🐳 Inception: 컨테이너 기반 마이크로서비스 아키텍처의 구현

**Inception**은 현대적인 웹 서비스를 어떻게 설계하고 배포하며 운영하는지에 대한 **아키텍처** 관점의 질문을 던진다.

이 프로젝트의 본질은 단순히 Docker 기술을 배우는 것을 넘어, 각기 다른 역할을 가진 여러 소프트웨어 구성 요소를 독립적인 **컨테이너(Container)**로 분리하고, 이들을 유기적으로 연결하여 하나의 완성된 서비스를 구축하는 **마이크로서비스 아키텍처(Microservices Architecture)**의 기본 원리를 체득하는 것이다.

Inception은 NGINX(웹 서버), WordPress(애플리케이션), MariaDB(데이터베이스)라는 고전적인 3-Tier 아키텍처를 컨테이너 기술로 구현하며, 개발과 운영의 경계를 허무는 **DevOps** 문화의 첫걸음을 경험하게 하는, 매우 실용적이고 중요한 과제이다. 

본 과제를 통해서, 기본적인 현대 서비스들의 기본 골자를 인지하고, 나아가선 실제 라이브로 수행되는 서비스들을 위한 청사진을 그려보는 연습, 그리고 그 다음 고지에 있는 대규모 서비스를 이해하는데 아주 좋은 시작지점을 만들어주는 과제라 할 수 있겠다. 

---

### 📜 아키텍처 설계: 모놀리식에서 마이크로서비스로

전통적인 웹 애플리케이션은 모든 기능(웹 서버, 애플리케이션 로직, 데이터베이스 접근)이 하나의 거대한 코드베이스 안에 뭉쳐있는 **모놀리식(Monolithic) 아키텍처**로 구성되는 경우가 많았다. Inception은 이와 달리 각 계층을 독립적인 서비스로 분리하여 다음과 같은 이점을 얻는다.

* **느슨한 결합 (Loose Coupling)**: 각 서비스는 독립적으로 개발, 배포, 업데이트될 수 있다. NGINX의 설정을 변경하는 것이 WordPress 코드에 영향을 주지 않는다.
* **기술 스택의 유연성**: 각 서비스는 자신의 역할에 가장 적합한 기술을 사용할 수 있다.
* **독립적인 확장성 (Scalability)**: 트래픽이 몰릴 때 데이터베이스는 그대로 두고 웹 서버 컨테이너만 여러 개로 늘리는 등, 필요한 부분만 선택적으로 확장하기 용이하다.

### 🛠️ 핵심 구성 요소와 컨테이너화된 역할

Inception 아키텍처의 각 서비스는 명확하게 정의된 책임을 가진다.

1.  **NGINX (웹 서버 / 리버스 프록시)**:
    * **역할**: 전체 서비스의 **진입점(Entry Point)**. 외부의 모든 HTTPS(443 포트) 요청을 가장 먼저 받아 처리한다.
    * **핵심 기능**:
        * **TLS 종료 (TLS Termination)**: 자체 서명된 인증서를 통해 SSL/TLS 암호화를 처리한다. 클라이언트와 NGINX 사이의 트래픽은 암호화되지만, NGINX와 내부 WordPress 서버 간의 통신은 암호화되지 않은 상태로 이루어져 내부 네트워크의 부하를 줄인다.
        * **리버스 프록시 (Reverse Proxy)**: 정적 콘텐츠(HTML, CSS, 이미지) 요청은 직접 처리하고, 동적인 PHP 스크립트 실행 요청이 들어오면 내부 네트워크의 WordPress 컨테이너(`wordpress:9000`)로 전달하는 역할을 한다. 이를 통해 클라이언트는 내부 애플리케이션 서버의 존재를 알 필요 없이 NGINX와만 통신하게 된다.

2.  **WordPress (애플리케이션 서버)**:
    * **역할**: 실제 웹 애플리케이션 로직을 수행한다.
    * **핵심 기능**:
        * **PHP-FPM (FastCGI Process Manager)**: NGINX로부터 FastCGI 프로토콜을 통해 전달받은 요청을 처리하여 동적인 웹 페이지를 생성한다.
        * **데이터베이스 연동**: 사용자의 요청에 따라 MariaDB 컨테이너에 데이터를 저장하거나 조회한다. 이 아키텍처에서 WordPress 자체는 상태를 저장하지 않는 **상태 비저장(Stateless)** 서버로 동작하며, 모든 영구 데이터는 데이터베이스에 위임한다.

3.  **MariaDB (데이터베이스 서버)**:
    * **역할**: 애플리케이션의 모든 데이터를 영구적으로 저장하는 **상태 저장(Stateful)** 컴포넌트이다. WordPress의 게시글, 사용자 정보, 설정 등이 모두 이곳에 저장된다.

---

### 🚀 Docker를 이용한 인프라 구축 및 관리

이러한 아키텍처는 Docker의 핵심 도구들을 통해 코드로 정의되고 관리된다.

1.  **Dockerfile: 서비스의 청사진 (Infrastructure as Code)**
    `Dockerfile`은 각 서비스(NGINX, WordPress, MariaDB)를 위한 컨테이너 이미지를 어떻게 빌드할지 정의하는 스크립트이다. 기본 OS 이미지(`debian:bullseye`) 위에 필요한 패키지를 설치하고, 설정 파일을 복사하며, 실행 명령을 지정하는 모든 과정이 코드로 명시된다. 이는 수동 설정의 오류를 없애고, 언제 어디서든 동일한 환경을 재현할 수 있게 하는 **인프라 코드화(Infrastructure as Code, IaC)**의 핵심 실천법이다.

2.  **Docker Compose: 다중 컨테이너 오케스트레이션**
    `docker-compose.yml` 파일은 이 모든 서비스와 그들의 관계를 **선언적(Declarative)**으로 정의하는 명세서이다. `services`, `networks`, `volumes` 키워드를 통해 여러 컨테이너로 구성된 전체 애플리케이션의 아키텍처를 정의한다. `docker-compose up` 명령어 하나로 모든 컨테이너를 생성하고, 네트워크를 설정하며, 볼륨을 연결하는 전체 스택을 실행할 수 있다. `depends_on` 옵션은 서비스 간의 의존성을 정의하여 실행 순서를 제어한다. 이 부분에서 Dockerfile 과의 역할에 대해 명확한 이해도가 없으면, 꼬이거나, 명령어를 덮어씌워 Dockerfile 의 레이어 구성에서 오류가 발생할 수 있다.

3.  **Docker Volumes: 데이터 영속성 보장**
    컨테이너는 삭제와 생성을 반복할 수 있는 **일시적인(Ephemeral)** 존재이다. 하지만 데이터베이스의 데이터와 같은 중요 정보는 영구적으로 보존되어야 한다. **Docker 볼륨**은 호스트 머신의 파일 시스템에 데이터를 저장하고, 이를 컨테이너 내부의 특정 경로에 마운트하는 기술이다. 단, 기본적으로 볼륨은 임시적 저장소로 설정되고, 당연히 컨테이너가 사라지거나 하면 저장되지 못한다. 이를 수정하여 볼륨을 외부로 만들어 이를 통해 컨테이너가 삭제되더라도 데이터는 호스트에 안전하게 남아, 데이터의 **영속성(Persistence)**을 보장해준다. 

4.  **Docker Networks: 서비스 간 통신과 서비스 디스커버리**
    `docker-compose`는 기본적으로 프로젝트를 위한 격리된 **브리지 네트워크(Bridge Network)**를 생성한다. 이 가상 네트워크 내에서, 각 컨테이너는 자신의 **서비스 이름(예: `nginx`, `wordpress`, `mariadb`)을 호스트 이름처럼 사용**하여 서로 통신할 수 있다. WordPress 설정 파일에 데이터베이스 호스트를 `localhost`가 아닌 `mariadb`로 지정할 수 있는 이유가 바로 이것이다. 이는 Docker가 제공하는 내장 **서비스 디스커버리(Service Discovery)** 기능 덕분이다. 도커 네트워크의 구성은 매우 중요한데, 기본적으로 각자의 통신 자체를 위해서도겠지만, 동시에 보안을 위해서도 필요한 조치다.

---

### ✨ 성찰 및 배운 점

Inception은 Docker 를 배우는 것 이상의 의미를 가진다. 실제로도 단순히 쿡북에 나와있는 명령어를 단순히 쳐서 해결되는 문제가 아니다. 

* **코드에서 인프라로의 관점 확장**: 현대 소프트웨어 개발은 애플리케이션 코드를 작성하는 것뿐만 아니라, 그 코드가 동작할 인프라를 직접 설계하고 코드로 관리하는 것까지 포함함을 깨달았다.
* **불변 인프라 (Immutable Infrastructure)**: 문제가 생겼을 때 실행 중인 컨테이너에 접속해 수정하는 것이 아니라, `Dockerfile`을 수정하고 새로운 이미지를 빌드하여 컨테이너를 교체하는 방식은, 더 예측 가능하고 안정적인 시스템을 만드는 '불변 인프라' 개념의 중요성을 가르쳐 준다.
* **DevOps의 첫걸음**: 개발(Dockerfile, 소스코드)과 운영(docker-compose.yml, 네트워크, 볼륨)이 분리된 것이 아니라, 하나의 `docker-compose` 워크플로우 안에서 통합되는 과정을 통해 DevOps 문화의 핵심 철학을 실질적으로 경험했다.

결론적으로 Inception은 개발자가 작성한 코드가 어떻게 견고한 아키텍처 위에서 실제 서비스로 구현되고 운영되는지에 대한 전체적인 시야를 제공하는, 매우 가치 있는 프로젝트다. 해당 프로젝트 이후 배우게 된 것들, 그리고 파이프라이닝 하는 감각은 실제 라이브 서비스에서 무중단 배포, Blue, Green 의 패턴을 활용하는 카나리아식 빌드, 그리고 제일 유용하다고 할 수 있는 이미지 차원에서의 프로그램 환경 배포를 가능케 하는데, 이 프로젝트는 그러한 점을 아주 잘 살린 시작점이 되는 프로젝트였다고 생각한다. 